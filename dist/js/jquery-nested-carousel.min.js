!function(e){function t(t,l){this.$ele=t,this.options=e.extend({},e.fn[i].defaults,l),this.init()}function l(e){var t,l;return t=e.css("transform"),t.indexOf("(")>=0?(t=t.split("(")[1],t=t.split(")")[0],t=t.split(","),l=Number(t[4])):l=0,l}var i="nestedTimeline";t.prototype={init:function(){var t,l,i=this;i._buildTemplate();var n=function(){var e=document.createElement("style");return document.head.appendChild(e),e.sheet}();i.options.states.forEach(function(e){var t="{";for(key in e.css)t+=key+":"+e.css[key]+";";t+="}",n.insertRule(".ns-horizontal-timeline ."+e.name+":after "+t,0)}),t=i.$ele.find(".list ol li.selected"),l=t.find("li a.selected"),t.find("div.active").text(l.data("content")),i.totalContentWidth=0,i.$ele.find(".list > ol >li").each(function(){i.totalContentWidth=i.totalContentWidth+e(this).outerWidth()}),i.containerWidth=i.$ele.find(".list").outerWidth(),i._attachEvents(),i._updateSlider(),i._updateSelectedContainerWidth()},_buildTemplate:function(){var t=this,l=e("<section class='ns-horizontal-timeline'><div class='timeline'> <div class='list-wrapper'> <div class='list'><div class='selected'></div></div></div></section>"),i=e("<ol></ol>");t.options.data.forEach(function(l){var n=e("<ul></ul>");l.list.forEach(function(l){var i=e("<a href='#0'></a>");i.data("content",l.name?l.name:"").attr("data-id",l.id),i.addClass(t.options.states[l.state].name),l.selected&&i.addClass("selected"),e("<li></li>").append(i).appendTo(n)}),e("<li class="+(l.selected?"selected":"")+"><div class='outer-list-name'>"+l.name+"</div></li>").append(n).append("<div class='inner-selected-name active'></div>").appendTo(i)}),l.find(".list").append(i),l.find(".timeline").append("<ul class='ns-timeline-navigation'> <li><a href='#0' class='prev'>Prev</a></li> <li><a href='#0' class='next'>Next</a></li></ul>"),console.log(l.html()),l.appendTo(t.$ele)},_attachEvents:function(){var t=this;t.$ele.find(".ns-timeline-navigation a.prev").on("click",function(l){l.preventDefault(),t.$ele.find("ol > li.selected").prev().length&&(t.$ele.find("ol > li.selected > div.active").text(""),t.$ele.find("ol > li.selected a.selected").removeClass("selected"),t.$ele.find("ol > li.selected").removeClass("selected").prev().addClass("selected").find("div.active").text(t.$ele.find("ol > li.selected a").data("content")),e(t.$ele.find("ol > li.selected a")[0]).addClass("selected"),t._updateSlider(),t._updateSelectedContainerWidth())}),t.$ele.find(".ns-timeline-navigation a.next").on("click",function(){event.preventDefault(),t.$ele.find("ol > li.selected").next().length&&(t.$ele.find("ol > li.selected > div.active").text(""),t.$ele.find("ol > li.selected a.selected").removeClass("selected"),t.$ele.find("ol > li.selected").removeClass("selected").next().addClass("selected").find("div.active").text(t.$ele.find("ol > li.selected a").data("content")),e(t.$ele.find("ol > li.selected a")[0]).addClass("selected"),t._updateSlider(),t._updateSelectedContainerWidth())}),t.$ele.find(".list ol").on("click","a",function(l){var i=e(l.target).closest("ol > li");l.preventDefault(),t.$ele.find("ol > li.selected > div.active").text(""),t.$ele.find("ol > li.selected a.selected").removeClass("selected"),i.hasClass("selected")||(t.$ele.find("ol > li.selected").removeClass("selected"),i.addClass("selected")),e(l.delegateTarget).find("li.selected div.active").text(e(l.target).addClass("selected").data("content")),t._updateSlider(),t._updateSelectedContainerWidth()})},_updateSlider:function(){var e,t,i,n,d=this;e=d.$ele.find(".list").offset().left+d.containerWidth/2-d.$ele.find("ol > li.selected").outerWidth()/2,t=d.$ele.find("ol li.selected").offset().left,n=e-t,i=l(d.$ele.find(".list ol")),d.$ele.find(".list ol").css("transform","translateX("+(i+n)+"px)")},_updateSelectedContainerWidth:function(){var e=this;parseInt(e.$ele.find(".list > .selected").css("min-width"))<e.$ele.find("ol > li.selected").outerWidth()?e.$ele.find(".list > .selected").width(e.$ele.find("ol > li.selected").outerWidth()):e.$ele.find(".list > .selected").css("width","")},changeState:function(e){var t=this,l=t.$ele.find(".list a[data-id='"+e.id+"']");t.options.states.forEach(function(e){l.removeClass(e.name)}),l.addClass(t.options.states[e.state].name)},destroy:function(){this.$ele.empty(),e.data(this.$ele,"plugin_"+i,null)}},e.fn[i]=function(l){var n=arguments;if(void 0==l||"object"==typeof l)return this.each(function(){e.data(this,"plugin_"+i)||e.data(this,"plugin_"+i,new t(e(this),l))});if("string"==typeof l&&"_"!==l[0]&&"init"!==l){var d;return this.each(function(){var s=e.data(this,"plugin_"+i);s instanceof t&&"function"==typeof s[l]&&(d=s[l].apply(s,Array.prototype.slice.call(n,1)))}),void 0!==d?d:this}},e.fn[i].defaults={states:[{name:"default",css:{"background-color":"white"}}]}}(jQuery);