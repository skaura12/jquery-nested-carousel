!function(e){function t(t,i){this.$ele=t,this.options=e.extend({},e.fn[l].defaults,i),this.init()}function i(e){var t,i;return t=e.css("transform"),t.indexOf("(")>=0?(t=t.split("(")[1],t=t.split(")")[0],t=t.split(","),i=Number(t[4])):i=0,i}var l="nestedTimeline";t.prototype={init:function(){var t,i,l=this;l._buildTemplate(),l._setNameContainerWidth(),t=l.$ele.find(".list ol li.selected"),i=t.find("li a.selected"),t.find("div.active > p").text(i.data("content")),t.prev().addClass("prev-of-selected"),l.totalContentWidth=0,l.$ele.find(".list > ol >li").each(function(){l.totalContentWidth=l.totalContentWidth+e(this).outerWidth()}),l.containerWidth=l.$ele.find(".list").outerWidth(),l._attachEvents(),l._updateSlider(),l._updateSelectedContainerWidth()},_buildTemplate:function(){var t=this,i=e("<section class='ns-horizontal-timeline'><div class='timeline'> <div class='list-wrapper'> <div class='list'><div class='selected'></div></div></div></section>"),l=e("<ol class='outer-nodes-container'></ol>");t.options.data.forEach(function(t){var i=e("<ul class='inner-nodes-container'></ul>");t.list.forEach(function(t){var l=e("<a href='#0'></a>");l.data("content",t.name?t.name:"").attr("data-id",t.id),l.addClass("state-"+t.state),t.selected&&l.addClass("selected"),e("<li class='inner-node'></li>").append(l).appendTo(i)}),e("<li class='outer-node "+(t.selected?"selected":"")+"'><div class='outer-list-name'><p>"+t.name+"</p></div></li>").append(i).append("<div class='inner-selected-name active'><p></p></div>").appendTo(l)}),i.find(".list").append(l),i.find(".timeline").append("<ul class='ns-timeline-navigation'> <li><a href='#0' class='prev'>Prev</a></li> <li><a href='#0' class='next'>Next</a></li></ul>"),i.appendTo(t.$ele)},_attachEvents:function(){var t=this;t.$ele.find(".ns-timeline-navigation a.prev").on("click",function(i){i.preventDefault(),t.$ele.find("ol > li.selected").prev().length&&(t.$ele.find("ol > li.selected > div.active > p").text(""),t.$ele.find("ol > li.selected a.selected").removeClass("selected"),t.$ele.find("ol > li.selected").prev().removeClass("prev-of-selected"),t.$ele.find("ol > li.selected").removeClass("selected").prev().addClass("selected").find("div.active > p").text(t.$ele.find("ol > li.selected a").data("content")),t.$ele.find("ol > li.selected").prev().addClass("prev-of-selected"),e(t.$ele.find("ol > li.selected a")[0]).addClass("selected"),t._updateSlider(),t._updateSelectedContainerWidth())}),t.$ele.find(".ns-timeline-navigation a.next").on("click",function(i){i.preventDefault(),t.$ele.find("ol > li.selected").next().length&&(t.$ele.find("ol > li.selected > div.active > p").text(""),t.$ele.find("ol > li.selected a.selected").removeClass("selected"),t.$ele.find("ol > li.selected").prev().removeClass("prev-of-selected"),t.$ele.find("ol > li.selected").removeClass("selected").next().addClass("selected").find("div.active > p").text(t.$ele.find("ol > li.selected a").data("content")).prev().addClass("prev-of-selected"),t.$ele.find("ol > li.selected").prev().addClass("prev-of-selected"),e(t.$ele.find("ol > li.selected a")[0]).addClass("selected"),t._updateSlider(),t._updateSelectedContainerWidth())}),t.$ele.find(".list .outer-nodes-container").on("click",".outer-node:not('.selected')",function(t){e(e(t.currentTarget).find(".inner-node a")[0]).trigger("click")}),t.$ele.find(".list .inner-nodes-container").on("click","a",function(i){i.preventDefault();var l=e(i.target).closest(".outer-node");t.$ele.find("ol > li.selected > div.active > p").text(""),t.$ele.find("ol > li.selected a.selected").removeClass("selected"),l.hasClass("selected")||(t.$ele.find("ol > li.selected").prev().removeClass("prev-of-selected"),t.$ele.find("ol > li.selected").removeClass("selected"),l.addClass("selected").prev().addClass("prev-of-selected"),t._updateSlider()),l.find("div.active > p").text(e(i.target).addClass("selected").data("content")),t._updateSelectedContainerWidth(),i.stopPropagation()}),e(window).on("resize",function(e){t.resize()})},_updateSlider:function(){var e,t,l,n,d=this;e=d.$ele.find(".list").offset().left+d.containerWidth/2-d.$ele.find("ol > li.selected").outerWidth()/2,t=d.$ele.find("ol li.selected").offset().left,n=e-t,l=i(d.$ele.find(".list ol")),d.$ele.find(".list ol").css("transform","translateX("+(l+n)+"px)"),d.$ele.find("ol > li.selected").next().length?d.$ele.find(".ns-timeline-navigation a.next").removeClass("inactive"):d.$ele.find(".ns-timeline-navigation a.next").addClass("inactive"),d.$ele.find("ol > li.selected").prev().length?d.$ele.find(".ns-timeline-navigation a.prev").removeClass("inactive"):d.$ele.find(".ns-timeline-navigation a.prev").addClass("inactive")},_updateSelectedContainerWidth:function(){var e=this;e.$ele.find(".list > .selected").width(e.$ele.find("ol > li.selected").outerWidth())},_setNameContainerWidth:function(){var t=this,i=t.$ele.find(".list ol > li");i.each(function(){var t=0,i=e(this);i.find("ul > li").each(function(){var i=e(this);t+=i.outerWidth()}),t>200?(i.find(".outer-list-name").css("width",t),i.find(".inner-selected-name").css("width",t)):(i.find(".outer-list-name").css("width",200),i.find(".inner-selected-name").css("width",200))})},changeState:function(e){var t=this,i=t.$ele.find(".list a[data-id='"+e.id+"']");i.removeClass(function(e,t){return(t.match(/\bstate-\S+/g)||[]).join(" ")}),i.addClass("state-"+e.state)},resize:function(){var e=this;e.containerWidth=e.$ele.find(".list").outerWidth(),e._updateSlider()},destroy:function(){this.$ele.empty(),e.data(this.$ele,"plugin_"+l,null)}},e.fn[l]=function(i){var n=arguments;if(void 0==i||"object"==typeof i)return this.each(function(){e.data(this,"plugin_"+l)||e.data(this,"plugin_"+l,new t(e(this),i))});if("string"==typeof i&&"_"!==i[0]&&"init"!==i){var d;return this.each(function(){var s=e.data(this,"plugin_"+l);s instanceof t&&"function"==typeof s[i]&&(d=s[i].apply(s,Array.prototype.slice.call(n,1)))}),void 0!==d?d:this}},e.fn[l].defaults={}}(jQuery);